<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script type="text/javascript" src="http://d3js.org/d3.v5.min.js"></script>
    <script src="https://code.highcharts.com/highcharts.js"></script>
<script src="https://code.highcharts.com/modules/data.js"></script>
<script src="https://code.highcharts.com/modules/exporting.js"></script>
<script src="https://code.highcharts.com/modules/accessibility.js"></script>
    <title>Document</title>
</head>
<body>
    <div id="container"></div>
    <table id="datatable">
        <thead>
            <tr>
                <th></th>
                <th>Boys</th>
                <th>Girls</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <th>2016</th>
                <td>30 386</td>
                <td>28 504</td>
            </tr>
            <tr>
                <th>2017</th>
                <td>29 173</td>
                <td>27 460</td>
            </tr>
            <tr>
                <th>2018</th>
                <td>28 430</td>
                <td>26 690</td>
            </tr>
            <tr>
                <th>2019</th>
                <td>28 042</td>
                <td>26 453</td>
            </tr>
            <tr>
                <th>2020</th>
                <td>27 063</td>
                <td>25 916</td>
            </tr>
            <tr>
                <th>2021</th>
                <td>28 684</td>
                <td>27 376</td>
            </tr>
        </tbody>
    </table>
    <table id="charttable">
        <thead>
            <tr>
                <th>군구명</th>
                <th>용 도</th>
                <th>승 용</th>
                <th>승 합</th>
                <th>화물</th>
                <th>특 수</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>중구</td>
                <td>비사업용</td>
                <td>636</td>
                <td>3</td>
                <td>54</td>
                <td>0</td>
            </tr>
            <tr>
                <td>중구</td>
                <td>사업용</td>
                <td>55</td>
                <td>12</td>
                <td>0</td>
                <td>0</td>
            </tr>
            <tr>
                <td>동구</td>
                <td>비사업용</td>
                <td>82</td>
                <td>0</td>
                <td>18</td>
                <td>0</td>
            </tr>
            <tr>
                <td>동구</td>
                <td>사업용</td>
                <td>22</td>
                <td>0</td>
                <td>37</td>
                <td>0</td>
            </tr>
            <tr>
                <td>미추홀구</td>
                <td>비사업용</td>
                <td>527</td>
                <td>0</td>
                <td>102</td>
                <td>0</td>
            </tr>
            <tr>
                <td>미추홀구</td>
                <td>사업용</td>
                <td>240</td>
                <td>0</td>
                <td>172</td>
                <td>0</td>
            </tr>
            <tr>
                <td>연수구</td>
                <td>비사업용</td>
                <td>1714</td>
                <td>2</td>
                <td>94</td>
                <td>0</td>
            </tr>
            <tr>
                <td>연수구</td>
                <td>사업용</td>
                <td>173</td>
                <td>67</td>
                <td>110</td>
                <td>0</td>
            </tr>
            <tr>
                <td>남동구</td>
                <td>비사업용</td>
                <td>1475</td>
                <td>0</td>
                <td>172</td>
                <td>0</td>
            </tr>
            <tr>
                <td>남동구</td>
                <td>사업용</td>
                <td>353</td>
                <td>0</td>
                <td>196</td>
                <td>0</td>
            </tr>
            <tr>
                <td>부평구</td>
                <td>비사업용</td>
                <td>904</td>
                <td>0</td>
                <td>85</td>
                <td>0</td>
            </tr>
            <tr>
                <td>부평구</td>
                <td>사업용</td>
                <td>107</td>
                <td>0</td>
                <td>179</td>
                <td>0</td>
            </tr>
            <tr>
                <td>계양구</td>
                <td>비사업용</td>
                <td>327</td>
                <td>0</td>
                <td>97</td>
                <td>0</td>
            </tr>
            <tr>
                <td>계양구</td>
                <td>사업용</td>
                <td>2906</td>
                <td>0</td>
                <td>142</td>
                <td>0</td>
            </tr>
            <tr>
                <td>서구</td>
                <td>비사업용</td>
                <td>1576</td>
                <td>0</td>
                <td>252</td>
                <td>0</td>
            </tr>
            <tr>
                <td>서구</td>
                <td>사업용</td>
                <td>183</td>
                <td>43</td>
                <td>223</td>
                <td>0</td>
            </tr>
            <tr>
                <td>강화군</td>
                <td>비사업용</td>
                <td>304</td>
                <td>0</td>
                <td>141</td>
                <td>0</td>
            </tr>
            <tr>
                <td>강화군</td>
                <td>사업용</td>
                <td>128</td>
                <td>24</td>
                <td>26</td>
                <td>0</td>
            </tr>
            <tr>
                <td>옹진군</td>
                <td>비사업용</td>
                <td>59</td>
                <td>0</td>
                <td>14</td>
                <td>0</td>
            </tr>
            <tr>
                <td>옹진군</td>
                <td>사업용</td>
                <td>12</td>
                <td>0</td>
                <td>6</td>
                <td>0</td>
            </tr>
        </tbody>
    </table>
    <input id="fileUpload" type="file"/ accept="*.csv">
<div id="content-result">&nbsp;</div>
</body>
<script>
//변수선언
const fileUpload = document.getElementById("fileUpload");
  const resultContent = document.getElementById('content-result');
  
  //파일이벤트 실행
  fileUpload.addEventListener('change',Upload)
  
  //업로드 함수
  function Upload() {
      console.log(fileUpload.files);
      
           // let regex = /^([a-zA-Z0-9\s_\\.\-:])+(.csv|.txt)$/; //csv파일 확인, 반드시 영어제목으로
           // if (regex.test(fileUpload.value.toLowerCase())) {
                if (typeof (FileReader) != "undefined") {
                    const reader = new FileReader();
                    reader.onload = function (e) {
                        console.log("Raw File");
                        console.log(e.target.result);
                        
                        let lines=e.target.result.split('\r');
                        for(let i = 0; i<lines.length; i++){
                        lines[i] = lines[i].replace(/\s/,'')//빈 공간 삭제하기
                        }
                        let result = [];
                        let headers=lines[0].split(",");

                        for(let i=1;i<lines.length;i++){
                            let obj = {};
                            let currentline=lines[i].split(",");

                            for(let j=0;j<headers.length;j++){
                                obj[headers[j]] = currentline[j];
                            }
                            result.push(obj);
                        }

                        //return result; //JavaScript 객체반환
                        console.log("After JSON Conversion");
                
                        console.log(JSON.stringify(result));
						resultContent.innerHTML += JSON.stringify(result)
                        return JSON.stringify(result); //JSON
                    }
                    reader.readAsText(fileUpload.files[0]);
                } else {
                    alert("This browser does not support HTML5.");
                }
           // } else {
               // alert("Please upload a valid CSV file.");
           // }
        }
</script>
</html>