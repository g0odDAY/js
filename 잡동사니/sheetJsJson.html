<!DOCTYPE html>

<head>
<meta charset="UTF-8">
<title>sheetjs create xlsx excel example(json)</title>
<script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.14.3/xlsx.full.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/1.3.8/FileSaver.min.js"></script>
</head>
<body>
파일 내보내기(JSON) : <input type="button" id="excelFileExport" value="엑셀 파일 다운로드(JSON)" />

<span class="text" style="width: 370px;" id="tApiNm">시간대별 운행 집계</span>

<textarea class="k-textbox mg_t15" style="width: 100%; height: 150px;" id="resultText">				
          [{"day":"20211000","tmzonCd":"00","cnt":64},{"day":"20211000","tmzonCd":"07","cnt":82},{"day":"20211000","tmzonCd":"08","cnt":20},{"day":"20211000","tmzonCd":"23","cnt":23},{"day":"20211001","tmzonCd":"14","cnt":14},{"day":"20211002","tmzonCd":"05","cnt":2},{"day":"20211002","tmzonCd":"08","cnt":15},{"day":"20211002","tmzonCd":"14","cnt":89},{"day":"20211002","tmzonCd":"15","cnt":76},{"day":"20211003","tmzonCd":"01","cnt":141},{"day":"20211003","tmzonCd":"03","cnt":9},{"day":"20211003","tmzonCd":"04","cnt":77},{"day":"20211003","tmzonCd":"11","cnt":49},{"day":"20211003","tmzonCd":"20","cnt":41},{"day":"20211004","tmzonCd":"01","cnt":93},{"day":"20211004","tmzonCd":"06","cnt":45},{"day":"20211004","tmzonCd":"07","cnt":124},{"day":"20211004","tmzonCd":"08","cnt":67},{"day":"20211004","tmzonCd":"09","cnt":53},{"day":"20211004","tmzonCd":"10","cnt":182},{"day":"20211004","tmzonCd":"19","cnt":58},{"day":"20211004","tmzonCd":"23","cnt":76},{"day":"20211005","tmzonCd":"00","cnt":56},{"day":"20211005","tmzonCd":"09","cnt":35},{"day":"20211005","tmzonCd":"10","cnt":43},{"day":"20211006","tmzonCd":"00","cnt":94},{"day":"20211006","tmzonCd":"03","cnt":13},{"day":"20211006","tmzonCd":"08","cnt":48},{"day":"20211006","tmzonCd":"09","cnt":38},{"day":"20211006","tmzonCd":"12","cnt":55},{"day":"20211006","tmzonCd":"14","cnt":75},{"day":"20211006","tmzonCd":"22","cnt":86},{"day":"20211007","tmzonCd":"05","cnt":97},{"day":"20211007","tmzonCd":"12","cnt":17},{"day":"20211008","tmzonCd":"11","cnt":46},{"day":"20211008","tmzonCd":"13","cnt":48},{"day":"20211008","tmzonCd":"23","cnt":13},{"day":"20211009","tmzonCd":"00","cnt":81},{"day":"20211009","tmzonCd":"07","cnt":31},{"day":"20211009","tmzonCd":"11","cnt":7},{"day":"20211009","tmzonCd":"14","cnt":44},{"day":"20211009","tmzonCd":"19","cnt":51},{"day":"20211009","tmzonCd":"20","cnt":26},{"day":"20211010","tmzonCd":"06","cnt":50},{"day":"20211010","tmzonCd":"11","cnt":58},{"day":"20211010","tmzonCd":"14","cnt":45},{"day":"20211010","tmzonCd":"15","cnt":88},{"day":"20211010","tmzonCd":"16","cnt":18},{"day":"20211010","tmzonCd":"23","cnt":75},{"day":"20211011","tmzonCd":"03","cnt":7},{"day":"20211011","tmzonCd":"07","cnt":55},{"day":"20211011","tmzonCd":"19","cnt":0},{"day":"20211012","tmzonCd":"07","cnt":39},{"day":"20211012","tmzonCd":"14","cnt":92},{"day":"20211013","tmzonCd":"02","cnt":19},{"day":"20211013","tmzonCd":"14","cnt":70},{"day":"20211013","tmzonCd":"17","cnt":57},{"day":"20211013","tmzonCd":"21","cnt":108},{"day":"20211013","tmzonCd":"22","cnt":0},{"day":"20211014","tmzonCd":"16","cnt":71},{"day":"20211014","tmzonCd":"18","cnt":49},{"day":"20211014","tmzonCd":"21","cnt":72},{"day":"20211014","tmzonCd":"22","cnt":7},{"day":"20211014","tmzonCd":"23","cnt":95},{"day":"20211015","tmzonCd":"12","cnt":18},{"day":"20211015","tmzonCd":"13","cnt":12},{"day":"20211016","tmzonCd":"03","cnt":70},{"day":"20211016","tmzonCd":"06","cnt":97},{"day":"20211016","tmzonCd":"07","cnt":90},{"day":"20211017","tmzonCd":"04","cnt":64},{"day":"20211017","tmzonCd":"06","cnt":13},{"day":"20211017","tmzonCd":"09","cnt":31},{"day":"20211017","tmzonCd":"10","cnt":83},{"day":"20211017","tmzonCd":"15","cnt":2},{"day":"20211017","tmzonCd":"23","cnt":27},{"day":"20211018","tmzonCd":"00","cnt":41},{"day":"20211018","tmzonCd":"05","cnt":86},{"day":"20211018","tmzonCd":"10","cnt":88},{"day":"20211018","tmzonCd":"11","cnt":68},{"day":"20211018","tmzonCd":"13","cnt":27},{"day":"20211018","tmzonCd":"17","cnt":0},{"day":"20211019","tmzonCd":"03","cnt":17},{"day":"20211019","tmzonCd":"05","cnt":99},{"day":"20211019","tmzonCd":"10","cnt":91},{"day":"20211019","tmzonCd":"11","cnt":98},{"day":"20211019","tmzonCd":"13","cnt":39},{"day":"20211019","tmzonCd":"17","cnt":56},{"day":"20211020","tmzonCd":"01","cnt":56},{"day":"20211020","tmzonCd":"04","cnt":37},{"day":"20211020","tmzonCd":"12","cnt":2},{"day":"20211020","tmzonCd":"19","cnt":91},{"day":"20211021","tmzonCd":"01","cnt":30},{"day":"20211021","tmzonCd":"03","cnt":3},{"day":"20211021","tmzonCd":"04","cnt":96},{"day":"20211021","tmzonCd":"07","cnt":2},{"day":"20211021","tmzonCd":"16","cnt":94},{"day":"20211021","tmzonCd":"17","cnt":14},{"day":"20211022","tmzonCd":"15","cnt":35},{"day":"20211022","tmzonCd":"19","cnt":46},{"day":"20211022","tmzonCd":"22","cnt":71},{"day":"20211023","tmzonCd":"02","cnt":41},{"day":"20211023","tmzonCd":"12","cnt":7},{"day":"20211023","tmzonCd":"14","cnt":61},{"day":"20211023","tmzonCd":"18","cnt":91},{"day":"20211023","tmzonCd":"21","cnt":18},{"day":"20211024","tmzonCd":"00","cnt":107},{"day":"20211024","tmzonCd":"04","cnt":55},{"day":"20211024","tmzonCd":"06","cnt":157},{"day":"20211024","tmzonCd":"10","cnt":18},{"day":"20211025","tmzonCd":"04","cnt":87},{"day":"20211025","tmzonCd":"13","cnt":53},{"day":"20211025","tmzonCd":"16","cnt":96},{"day":"20211025","tmzonCd":"22","cnt":23},{"day":"20211026","tmzonCd":"02","cnt":86},{"day":"20211026","tmzonCd":"13","cnt":28},{"day":"20211026","tmzonCd":"15","cnt":77},{"day":"20211026","tmzonCd":"17","cnt":11},{"day":"20211026","tmzonCd":"19","cnt":92},{"day":"20211026","tmzonCd":"20","cnt":79},{"day":"20211026","tmzonCd":"21","cnt":71},{"day":"20211026","tmzonCd":"23","cnt":63},{"day":"20211027","tmzonCd":"08","cnt":51},{"day":"20211027","tmzonCd":"09","cnt":14},{"day":"20211027","tmzonCd":"11","cnt":75},{"day":"20211028","tmzonCd":"06","cnt":81},{"day":"20211028","tmzonCd":"08","cnt":88},{"day":"20211028","tmzonCd":"14","cnt":95},{"day":"20211028","tmzonCd":"15","cnt":75},{"day":"20211028","tmzonCd":"16","cnt":80},{"day":"20211028","tmzonCd":"20","cnt":37},{"day":"20211028","tmzonCd":"22","cnt":50},{"day":"20211029","tmzonCd":"02","cnt":29},{"day":"20211029","tmzonCd":"17","cnt":71},{"day":"20211200","tmzonCd":"00","cnt":82},{"day":"20211200","tmzonCd":"06","cnt":15},{"day":"20211200","tmzonCd":"07","cnt":37},{"day":"20211200","tmzonCd":"12","cnt":76},{"day":"20211200","tmzonCd":"14","cnt":99},{"day":"20211200","tmzonCd":"16","cnt":91},{"day":"20211200","tmzonCd":"19","cnt":74},{"day":"20211200","tmzonCd":"20","cnt":89},{"day":"20211200","tmzonCd":"23","cnt":19},{"day":"20211201","tmzonCd":"06","cnt":63},{"day":"20211201","tmzonCd":"07","cnt":21},{"day":"20211201","tmzonCd":"08","cnt":23},{"day":"20211201","tmzonCd":"12","cnt":94},{"day":"20211201","tmzonCd":"14","cnt":66},{"day":"20211201","tmzonCd":"19","cnt":77},{"day":"20211202","tmzonCd":"06","cnt":13},{"day":"20211202","tmzonCd":"07","cnt":52},{"day":"20211202","tmzonCd":"11","cnt":64},{"day":"20211202","tmzonCd":"19","cnt":55},{"day":"20211202","tmzonCd":"23","cnt":54},{"day":"20211203","tmzonCd":"06","cnt":96},{"day":"20211204","tmzonCd":"03","cnt":99},{"day":"20211204","tmzonCd":"06","cnt":99},{"day":"20211204","tmzonCd":"21","cnt":75},{"day":"20211205","tmzonCd":"03","cnt":66},{"day":"20211205","tmzonCd":"04","cnt":32},{"day":"20211205","tmzonCd":"06","cnt":87},{"day":"20211205","tmzonCd":"08","cnt":61},{"day":"20211205","tmzonCd":"23","cnt":45},{"day":"20211206","tmzonCd":"02","cnt":28},{"day":"20211206","tmzonCd":"10","cnt":46},{"day":"20211206","tmzonCd":"11","cnt":40},{"day":"20211206","tmzonCd":"16","cnt":28},{"day":"20211207","tmzonCd":"01","cnt":9},{"day":"20211207","tmzonCd":"02","cnt":63},{"day":"20211207","tmzonCd":"06","cnt":95},{"day":"20211207","tmzonCd":"07","cnt":42},{"day":"20211208","tmzonCd":"04","cnt":66},{"day":"20211208","tmzonCd":"06","cnt":73},{"day":"20211209","tmzonCd":"04","cnt":39},{"day":"20211209","tmzonCd":"23","cnt":82},{"day":"20211210","tmzonCd":"03","cnt":144},{"day":"20211210","tmzonCd":"05","cnt":76},{"day":"20211210","tmzonCd":"06","cnt":45},{"day":"20211210","tmzonCd":"11","cnt":61},{"day":"20211210","tmzonCd":"12","cnt":20},{"day":"20211210","tmzonCd":"21","cnt":16},{"day":"20211211","tmzonCd":"06","cnt":179},{"day":"20211211","tmzonCd":"10","cnt":14},{"day":"20211212","tmzonCd":"01","cnt":70},{"day":"20211212","tmzonCd":"06","cnt":31},{"day":"20211212","tmzonCd":"11","cnt":15},{"day":"20211213","tmzonCd":"01","cnt":89},{"day":"20211213","tmzonCd":"06","cnt":8},{"day":"20211213","tmzonCd":"08","cnt":69},{"day":"20211213","tmzonCd":"09","cnt":61},{"day":"20211213","tmzonCd":"16","cnt":22},{"day":"20211213","tmzonCd":"19","cnt":49},{"day":"20211213","tmzonCd":"22","cnt":38},{"day":"20211214","tmzonCd":"08","cnt":74},{"day":"20211214","tmzonCd":"19","cnt":42},{"day":"20211214","tmzonCd":"23","cnt":98},{"day":"20211215","tmzonCd":"02","cnt":10},{"day":"20211215","tmzonCd":"04","cnt":12},{"day":"20211215","tmzonCd":"20","cnt":85},{"day":"20211216","tmzonCd":"02","cnt":97},{"day":"20211216","tmzonCd":"06","cnt":48},{"day":"20211216","tmzonCd":"09","cnt":3},{"day":"20211216","tmzonCd":"11","cnt":46},{"day":"20211216","tmzonCd":"13","cnt":86},{"day":"20211216","tmzonCd":"17","cnt":59},{"day":"20211216","tmzonCd":"20","cnt":14},{"day":"20211217","tmzonCd":"00","cnt":58},{"day":"20211217","tmzonCd":"01","cnt":20},{"day":"20211217","tmzonCd":"12","cnt":76},{"day":"20211217","tmzonCd":"13","cnt":4},{"day":"20211217","tmzonCd":"14","cnt":57},{"day":"20211218","tmzonCd":"06","cnt":80},{"day":"20211218","tmzonCd":"09","cnt":17},{"day":"20211218","tmzonCd":"13","cnt":74},{"day":"20211219","tmzonCd":"00","cnt":12},{"day":"20211219","tmzonCd":"01","cnt":68},{"day":"20211219","tmzonCd":"02","cnt":57},{"day":"20211219","tmzonCd":"13","cnt":96},{"day":"20211219","tmzonCd":"16","cnt":84},{"day":"20211219","tmzonCd":"18","cnt":73},{"day":"20211220","tmzonCd":"00","cnt":7},{"day":"20211220","tmzonCd":"14","cnt":36},{"day":"20211220","tmzonCd":"20","cnt":50},{"day":"20211221","tmzonCd":"02","cnt":14},{"day":"20211221","tmzonCd":"04","cnt":32},{"day":"20211221","tmzonCd":"05","cnt":1},{"day":"20211221","tmzonCd":"06","cnt":80},{"day":"20211221","tmzonCd":"07","cnt":88},{"day":"20211221","tmzonCd":"16","cnt":15},{"day":"20211222","tmzonCd":"05","cnt":85},{"day":"20211222","tmzonCd":"06","cnt":2},{"day":"20211222","tmzonCd":"10","cnt":26},{"day":"20211222","tmzonCd":"11","cnt":99},{"day":"20211222","tmzonCd":"19","cnt":82},{"day":"20211222","tmzonCd":"21","cnt":54},{"day":"20211222","tmzonCd":"22","cnt":68},{"day":"20211223","tmzonCd":"13","cnt":41},{"day":"20211223","tmzonCd":"21","cnt":86},{"day":"20211224","tmzonCd":"06","cnt":150},{"day":"20211224","tmzonCd":"08","cnt":21},{"day":"20211224","tmzonCd":"11","cnt":77},{"day":"20211224","tmzonCd":"22","cnt":49},{"day":"20211225","tmzonCd":"06","cnt":85},{"day":"20211225","tmzonCd":"11","cnt":86},{"day":"20211225","tmzonCd":"19","cnt":1},{"day":"20211225","tmzonCd":"22","cnt":26},{"day":"20211226","tmzonCd":"09","cnt":36},{"day":"20211226","tmzonCd":"10","cnt":18},{"day":"20211226","tmzonCd":"20","cnt":87},{"day":"20211226","tmzonCd":"22","cnt":111},{"day":"20211227","tmzonCd":"03","cnt":79},{"day":"20211227","tmzonCd":"06","cnt":97},{"day":"20211227","tmzonCd":"10","cnt":64},{"day":"20211227","tmzonCd":"11","cnt":96},{"day":"20211227","tmzonCd":"12","cnt":87},{"day":"20211227","tmzonCd":"21","cnt":24},{"day":"20211227","tmzonCd":"22","cnt":46},{"day":"20211228","tmzonCd":"05","cnt":23},{"day":"20211228","tmzonCd":"06","cnt":50},{"day":"20211228","tmzonCd":"19","cnt":89},{"day":"20211228","tmzonCd":"20","cnt":37},{"day":"20211229","tmzonCd":"01","cnt":1},{"day":"20211229","tmzonCd":"05","cnt":31},{"day":"20211229","tmzonCd":"08","cnt":10},{"day":"20211229","tmzonCd":"22","cnt":20},{"day":"20211229","tmzonCd":"23","cnt":54}]   
</textarea>
</body>
<script>
     const excelTitle = document.getElementById("tApiNm").innerText; 
     const resultText = document.getElementById("resultText").textContent;
     const arry = [...resultText];
     const obj = {resultText};
     const parseJson= JSON.parse(resultText);
     console.log(arry);
     console.log(obj);
     console.log(parseJson);
     console.log(resultText);
     console.log(excelTitle)
    //공통
    // 참고 출처 : https://redstapler.co/sheetjs-tutorial-create-xlsx/
    function s2ab(s) { 
        var buf = new ArrayBuffer(s.length); //convert s to arrayBuffer
        var view = new Uint8Array(buf);  //create uint8array as viewer
        for (var i=0; i<s.length; i++) view[i] = s.charCodeAt(i) & 0xFF; //convert to octet
        return buf;    
    }
    function exportExcel(){ 
        // step 1. workbook 생성
        var wb = XLSX.utils.book_new();
    
        // step 2. 시트 만들기 
        var newWorksheet = excelHandler.getWorksheet();
        
        // step 3. workbook에 새로만든 워크시트에 이름을 주고 붙인다.  
        XLSX.utils.book_append_sheet(wb, newWorksheet, excelHandler.getSheetName());
    
        // step 4. 엑셀 파일 만들기 
        var wbout = XLSX.write(wb, {bookType:'xlsx',  type: 'binary'});
    
        // step 5. 엑셀 파일 내보내기 
        saveAs(new Blob([s2ab(wbout)],{type:"application/octet-stream"}), excelHandler.getExcelFileName());
    }
    $(document).ready(function() { 
        $("#excelFileExport").click(function(){
            exportExcel();
        });
    });

    const result =[{"day":"20210121","cnt":1,"mileAge":0,"drivingTime":1281},{"day":"20210122","cnt":1,"mileAge":0,"drivingTime":1151},{"day":"20210123","cnt":1,"mileAge":0,"drivingTime":1007},{"day":"20210126","cnt":1,"mileAge":0,"drivingTime":420},{"day":"20210127","cnt":1,"mileAge":0,"drivingTime":38},{"day":"20210209","cnt":1,"mileAge":0,"drivingTime":292},{"day":"20210210","cnt":1,"mileAge":0,"drivingTime":783},{"day":"20210315","cnt":1,"mileAge":0,"drivingTime":402},{"day":"20210316","cnt":1,"mileAge":0,"drivingTime":53},{"day":"20210317","cnt":1,"mileAge":0,"drivingTime":3},{"day":"20210614","cnt":1,"mileAge":1.6,"drivingTime":92},{"day":"20210615","cnt":1,"mileAge":0.6,"drivingTime":37},{"day":"20210730","cnt":168,"mileAge":0,"drivingTime":0},{"day":"20210731","cnt":9,"mileAge":0,"drivingTime":0},{"day":"20210801","cnt":162,"mileAge":0,"drivingTime":0},{"day":"20210802","cnt":2,"mileAge":0,"drivingTime":0},{"day":"20210803","cnt":19,"mileAge":0,"drivingTime":0},{"day":"20210804","cnt":5,"mileAge":0,"drivingTime":0},{"day":"20210805","cnt":2,"mileAge":0,"drivingTime":0},{"day":"20210806","cnt":2,"mileAge":0,"drivingTime":0},{"day":"20210820","cnt":1,"mileAge":6.2,"drivingTime":62},{"day":"20210910","cnt":1,"mileAge":2.1,"drivingTime":96},{"day":"20210915","cnt":1,"mileAge":45.7,"drivingTime":379},{"day":"20211012","cnt":1,"mileAge":310,"drivingTime":959},{"day":"20211013","cnt":1,"mileAge":719.7,"drivingTime":1969},{"day":"20211014","cnt":1,"mileAge":499.2,"drivingTime":1667},{"day":"20211020","cnt":1,"mileAge":0,"drivingTime":17},{"day":"20211201","cnt":13,"mileAge":1234.1,"drivingTime":5885},{"day":"20211202","cnt":12,"mileAge":1881.6,"drivingTime":7322},{"day":"20211203","cnt":12,"mileAge":1692.5,"drivingTime":6802},{"day":"20211204","cnt":9,"mileAge":439.8,"drivingTime":3219},{"day":"20211205","cnt":6,"mileAge":215.1,"drivingTime":1879},{"day":"20211206","cnt":13,"mileAge":1488.6,"drivingTime":5046},{"day":"20211207","cnt":13,"mileAge":1212.2,"drivingTime":6335},{"day":"20211208","cnt":13,"mileAge":738.8,"drivingTime":5668},{"day":"20211209","cnt":14,"mileAge":1011.9,"drivingTime":6222},{"day":"20211210","cnt":15,"mileAge":1970.3,"drivingTime":8235},{"day":"20211211","cnt":9,"mileAge":516.2,"drivingTime":3626},{"day":"20211212","cnt":7,"mileAge":313.3,"drivingTime":1967},{"day":"20211213","cnt":13,"mileAge":1721.1,"drivingTime":6847},{"day":"20211214","cnt":13,"mileAge":1863.9,"drivingTime":7060},{"day":"20211215","cnt":11,"mileAge":1476.5,"drivingTime":5342},{"day":"20211216","cnt":13,"mileAge":1758.8,"drivingTime":7054},{"day":"20211217","cnt":13,"mileAge":1716.9,"drivingTime":7015},{"day":"20211218","cnt":10,"mileAge":894.6,"drivingTime":4076},{"day":"20211219","cnt":10,"mileAge":277.1,"drivingTime":2638},{"day":"20211220","cnt":13,"mileAge":1378.3,"drivingTime":6799},{"day":"20211221","cnt":12,"mileAge":1574.7,"drivingTime":6387},{"day":"20211222","cnt":12,"mileAge":1128.4,"drivingTime":6177},{"day":"20211223","cnt":14,"mileAge":1047.5,"drivingTime":5677},{"day":"20211224","cnt":9,"mileAge":456.2,"drivingTime":3672},{"day":"20211225","cnt":5,"mileAge":107.1,"drivingTime":1670},{"day":"20211226","cnt":7,"mileAge":430.3,"drivingTime":2318},{"day":"20211227","cnt":12,"mileAge":1207.7,"drivingTime":6192},{"day":"20211228","cnt":11,"mileAge":2017.4,"drivingTime":7454},{"day":"20211229","cnt":12,"mileAge":1202.1,"drivingTime":6349},{"day":"20211230","cnt":12,"mileAge":1274,"drivingTime":6543},{"day":"20211231","cnt":9,"mileAge":284.3,"drivingTime":3032}];
    var excelHandler = {
            getExcelFileName : function(){
                return 'json-test.xlsx';
            },
            getSheetName : function(){
                return 'Json Test Sheet';
            },
            getExcelData : function(){
                return result; 
            },
            getWorksheet : function(){
                return XLSX.utils.json_to_sheet(this.getExcelData());
            }
    }
    </script>
</html>